Code added by Pierce Darragh.
